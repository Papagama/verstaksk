/**
 * ===========================================
 * PORTFOLIO MODULE
 * ===========================================
 * 
 * Этот модуль отвечает за:
 * 1. Хранение данных о работах в массиве объектов
 * 2. Динамический рендеринг карточек в DOM
 * 3. Пагинацию с возможностью настройки
 * 
 * КАК ДОБАВИТЬ НОВУЮ РАБОТУ:
 * Добавьте новый объект в массив portfolioData с полями:
 * - id: уникальный идентификатор (число)
 * - title: название проекта
 * - tag: тег/категория (например: "Landing", "Online store")
 * - description: описание проекта
 * - image: путь к изображению
 * - link: ссылка на проект
 * 
 * КАК ИЗМЕНИТЬ КОЛИЧЕСТВО РАБОТ НА СТРАНИЦЕ:
 * Измените значение константы ITEMS_PER_PAGE ниже
 */

// ===========================================
// КОНФИГУРАЦИЯ
// ===========================================

// Количество работ на одной странице (измените это значение для настройки)
const ITEMS_PER_PAGE = 6;

// ===========================================
// ДАННЫЕ ПОРТФОЛИО
// ===========================================
// Массив объектов с информацией о каждой работе
// Добавляйте новые работы в этот массив

const portfolioData = [
  {
    id: 1,
    title: "Architecture chaos",
    tag: "Landing",
    description: "«Концептуальный сайт архитектурной студии Modern Arch Studio.",
    image: "images/case1.png",
    link: "https://architecture-cchaos.netlify.app",

    // Extended attributes for Case Study
    overview:
      "Учебный концептуальный проект архитектурной студии, специализирующейся на экспериментальных и асимметричных решениях. Цель проекта — через визуальный стиль, типографику и сетку передать идею «хаоса как источника формы» и показать, как нестандартные приёмы могут работать в вебе.",

    client: "Учебный концепт (самостоятельный проект)",
    year: "2024",

    tasks: [
      "Разработать концепцию сайта и визуальную идею проекта",
      "Спроектировать нестандартную сетку с ощущением управляемого хаоса",
      "Сверстать адаптивный лендинг без использования конструкторов",
      "Реализовать анимации, усиливающие архитектурную концепцию",
      "Подготовить сайт к публикации и размещению в сети"
    ],

    constraints: [
      "Проект является учебным, без реального заказчика",
      "Отсутствие дизайн-макета — дизайн создавался сразу в коде",
      "Необходимо сохранить баланс между хаотичной подачей и удобством восприятия",
      "Ограничение по производительности при активных анимациях"
    ],

    solution:
      "Я начал с идеи и смысловой концепции проекта, сформировав визуальный образ архитектурной студии. Далее разработал структуру страницы и нестандартную сетку на основе CSS Grid. Вёрстка выполнена с упором на чистую семантику и адаптивность. Анимации реализованы с помощью GSAP и используются дозированно, чтобы подчеркнуть динамику, не перегружая интерфейс.",

    technologies: [
      { name: "HTML5", desc: "Семантическая разметка структуры страницы" },
      { name: "CSS3 / SCSS", desc: "Сложные сетки, типографика и анимации" },
      { name: "JavaScript (ES6+)", desc: "Логика интерактивных элементов" },
      { name: "GSAP", desc: "Анимация элементов и переходов" }
    ],

    results: [
      "Создан полностью рабочий концептуальный лендинг",
      "Реализована нестандартная архитектурная сетка",
      "Сайт корректно отображается на разных устройствах",
      "Проект демонстрирует работу с анимациями и сложной типографикой",
      "Сайт успешно размещён и доступен онлайн"
    ],

    screenshots: {
        desktop: "images/screen1.jpg"
    },

    role:
      "Я выступал в роли дизайнера и фронтенд-разработчика: придумал идею проекта, разработал визуальную концепцию, выполнил вёрстку, реализовал анимации и подготовил сайт к публикации.",

    summary:
      "Этот учебный проект позволил мне пройти полный цикл создания сайта — от идеи и концепции до готового опубликованного продукта. Работа помогла углубить знания в CSS Grid, анимациях и работе с нестандартной композицией."
  },
    {
    id: 2,
    title: "Белые Ягуары",
    tag: "Landing",
    description: "Учебный лендинг сообщества, созданный с использованием нейросетей и доведённый до аккуратного, цельного интерфейса.",
    image: "images/case2.png",
    link: "https://b33-superheroes.lovable.app",

    // Extended attributes for Case Study
    overview:
      "Учебный проект лендинга для сообщества «Белые Ягуары». Цель — собрать атмосферную страницу с характером: тёмная подача, красные акценты, уверенная типографика и блоки, которые последовательно раскрывают идею команды (ценности, участники, моменты, FAQ). Проект выполнен как практика использования нейросетей в веб-разработке: от генерации структуры и текстов до финальной сборки и презентации.",

    client: "Учебный проект (самостоятельная работа)",
    year: "2024",

    tasks: [
      "Сформировать концепцию и структуру лендинга с помощью нейросетей",
      "Собрать и организовать контентные блоки (первый экран, ценности, команда, моменты, FAQ)",
      "Привести интерфейс к единому стилю: тёмная тема, акцентный цвет, типографика",
      "Проверить адаптацию под разные устройства и обеспечить аккуратный внешний вид на мобильных",
      "Подготовить проект к публикации и оформлению в портфолио"
    ],

    constraints: [
      "Проект учебный, без реального заказчика и брендбука",
      "Часть текстов и структуры генерировались нейросетями — важно было добиться единого тона и логики",
      "Тёмная тема требует контроля контрастности и читаемости",
      "Нужно было сохранить баланс: атмосферность без перегрузки акцентами"
    ],

    solution:
      "Я начал с генерации структуры и смысловых блоков с помощью нейросетей: собрал основу страницы, тексты и направления по стилю. Затем вручную довёл сайт до цельного результата: выстроил композицию блоков, выровнял типографику, усилил визуальные акценты и проверил адаптацию под разные экраны. В итоге получился понятный и атмосферный лендинг, который демонстрирует и навыки верстки, и умение использовать AI как рабочий инструмент.",

    technologies: [
      { name: "HTML5", desc: "Семантическая структура страницы и логика контентных блоков" },
      { name: "CSS3", desc: "Стилизация, сетки, типографика, тёмная тема и акцентные состояния" },
      { name: "JavaScript (ES6+)", desc: "Лёгкая интерактивность и поведение элементов интерфейса" },
      { name: "Нейросети (AI-инструменты)", desc: "Генерация структуры, текстов и UI-идей, ускорение работы" }
    ],

    results: [
      "Создан готовый учебный лендинг с цельной визуальной подачей",
      "Собрана понятная структура и история страницы (ценности → команда → моменты → FAQ)",
      "Проект корректно выглядит на разных устройствах, включая мобильные",
      "Получен опыт интеграции нейросетей в процесс разработки",
      "Сайт опубликован и доступен онлайн"
    ],

    screenshots: {
      desktop: "images/screen2.jpg",
      // mobile: "images/screen-whitejaguars-mobile.jpg",
    },

    role:
      "Я выступал в роли разработчика и куратора концепции: с помощью нейросетей собрал структуру, тексты и варианты визуальной подачи, затем самостоятельно довёл интерфейс до цельного вида, проверил адаптивность и подготовил проект к публикации.",

    summary:
      "Этот учебный проект помог мне отработать быстрый и при этом контролируемый подход: использовать нейросети как инструмент для генерации и ускорения, но финальное качество доводить вручную. В результате получился аккуратный лендинг с атмосферой и понятной логикой, который можно уверенно показать в портфолио."
  },

  {
  id: 3,
  title: "Form & Function",
  tag: "Landing",
  description:
    "«Лендинг мебельной мастерской, собранный на стандартных блоках Tilda с упором на чистую композицию, атмосферу и аккуратную подачу.",

  image: "images/case3.png",
  link: "https://mebel5555.tilda.ws", 

  // Extended attributes for Case Study
  overview:
    "Учебный проект лендинга для мебельной мастерской Form & Function. Цель — собрать спокойную, тёплую и доверительную страницу, которая подчёркивает качество мебели и индивидуальный подход. Проект выполнен на стандартных блоках Tilda: без кастомного кода, но с вниманием к композиции, отступам, типографике и визуальному ритму.",

  client: "Учебный проект (самостоятельная работа)",
  year: "2024",

  tasks: [
    "Продумать структуру лендинга для мебельной мастерской",
    "Собрать страницу на стандартных блоках Tilda без использования Zero Block",
    "Выстроить визуальную и смысловую иерархию блоков",
    "Подобрать изображения и тексты, создающие атмосферу уюта и качества",
    "Проверить адаптацию сайта под мобильные устройства"
  ],

  constraints: [
    "Использование только стандартных блоков Tilda",
    "Учебный формат без реального заказчика и брендбука",
    "Ограниченные возможности кастомизации блоков",
    "Важно было избежать ощущения «шаблонности»"
  ],

  solution:
    "Я начал с продумывания логики страницы: первый экран — ценностное предложение, далее — примеры работ, преимущества, этапы сотрудничества, отзывы и форма связи. Затем собрал сайт на стандартных блоках Tilda, уделяя внимание отступам, последовательности экранов и визуальному балансу. За счёт аккуратной композиции, нейтральной цветовой палитры и качественных изображений удалось добиться цельного и спокойного интерфейса.",

  technologies: [
    { name: "Tilda", desc: "Сборка лендинга на стандартных блоках без кастомного кода" },
    { name: "UI-композиция", desc: "Работа с отступами, ритмом и визуальной иерархией" },
    { name: "Контент-подача", desc: "Подбор изображений и текстов для создания атмосферы" },
    { name: "Адаптивность", desc: "Проверка и корректировка отображения на разных устройствах" }
  ],

  results: [
    "Собран цельный учебный лендинг мебельной мастерской",
    "Выстроена понятная структура страницы без перегрузки",
    "Сайт аккуратно выглядит на десктопе и мобильных устройствах",
    "Получен практический опыт работы со стандартными блоками Tilda",
    "Проект оформлен и добавлен в портфолио"
  ],

  screenshots: {
    desktop: "images/screen3.jpg"
  },

  role:
    "Я выступал в роли дизайнера и сборщика сайта: продумал структуру, логику блоков и визуальную подачу, собрал лендинг на стандартных блоках Tilda, проверил адаптивность и подготовил проект для портфолио.",

  summary:
    "Этот учебный проект показал, что даже на стандартных блоках Tilda можно собрать аккуратный и визуально цельный сайт. Основной акцент был сделан не на сложных эффектах, а на логике, композиции и атмосфере — именно эти навыки я и хотел отработать в данном кейсе."
},

   {
  id: 4,
  title: "TechStore",
  tag: "Online Store",
  description:
    "Концепт интернет-магазина электроники с каталогом, карточками товаров и базовой логикой интерфейса, созданный с использованием нейросетей.",

  image: "images/case4.png",
  link: "https://papagama.github.io/techstore2/",

  // Extended attributes for Case Study
  overview:
    "Учебный концептуальный проект интернет-магазина электроники. Цель — собрать визуально чистый и логически понятный интерфейс e-commerce: от первого экрана до каталога, карточек товаров и контактного блока. Проект создавался как практика использования нейросетей для генерации структуры, текстов и UI-идей с последующей ручной доработкой и реализацией во фронтенде.",

  client: "Учебный проект (самостоятельная работа)",
  year: "2024",

  tasks: [
    "Сформировать концепцию интернет-магазина электроники",
    "Продумать структуру главной страницы и каталога товаров",
    "Реализовать карточки товаров с ценами и CTA-кнопками",
    "Выстроить визуальную иерархию блоков и сетку каталога",
    "Собрать аккуратный адаптивный интерфейс для десктопа и мобильных"
  ],

  constraints: [
    "Проект учебный, без реального заказчика и бизнес-логики",
    "Концепт без подключения реальной корзины и оплаты",
    "Часть структуры и текстов сгенерирована нейросетями",
    "Важно было сохранить ощущение «реального магазина», а не шаблона"
  ],

  solution:
    "Я начал с генерации концепции и структуры интернет-магазина с помощью нейросетей: категории товаров, логика каталога, наполнение карточек. Затем вручную реализовал интерфейс — выстроил сетку каталога, оформил карточки товаров, кнопки и навигацию. Основной упор сделал на чистоту интерфейса, читаемость, визуальный ритм и понятный пользовательский путь от просмотра товаров к действию.",

  technologies: [
    { name: "HTML5", desc: "Семантическая структура страниц и каталога" },
    { name: "CSS3", desc: "Сетки, карточки товаров, типографика и адаптивность" },
    { name: "JavaScript (ES6+)", desc: "Базовая логика интерфейса и интерактивность" },
    { name: "Нейросети (AI-инструменты)", desc: "Генерация структуры, текстов и UI-концепта" }
  ],

  results: [
    "Создан учебный концепт интернет-магазина электроники",
    "Реализован каталог товаров с карточками и ценами",
    "Выстроен понятный пользовательский путь по странице",
    "Интерфейс корректно адаптируется под разные устройства",
    "Получен практический опыт проектирования e-commerce интерфейсов"
  ],

  screenshots: {
    desktop: "images/screen4.jpg"
  },

  role:
    "Я выступал в роли фронтенд-разработчика и автора концепции: с помощью нейросетей сформировал структуру и идеи интерфейса, затем самостоятельно реализовал дизайн и логику страниц, адаптацию и финальную сборку проекта.",

  summary:
    "Этот учебный проект стал практикой проектирования e-commerce интерфейсов: от структуры каталога до визуальной подачи карточек товаров. Я использовал нейросети как инструмент для ускорения идей и прототипирования, а финальное качество и логику доводил вручную. Проект хорошо демонстрирует понимание структуры интернет-магазинов и основы клиентской логики."
    },
   {
  id: 5,
  title: "Блог",
  tag: "Blog Concept",
  description:
    "Учебный концепт блога с минималистичным интерфейсом, карточками статей и базовой логикой управления контентом, созданный как практика проектирования и работы с нейросетями.",

  image: "images/case5.png",
  link: "https://papagama.github.io/blog-project",

  // Extended attributes for Case Study
  overview:
    "Учебный концептуальный проект блога — пространства для идей, заметок и статей. Цель проекта — создать чистый, спокойный и удобный интерфейс, в котором контент находится в центре внимания. Проект выполнен как практика проектирования блоговой структуры с использованием нейросетей для генерации идей, текстов и UI-направлений и последующей ручной реализации.",

  client: "Учебный проект (самостоятельная работа)",
  year: "2026",

  tasks: [
    "Сформировать концепцию минималистичного блога",
    "Продумать структуру главной страницы со списком статей",
    "Реализовать карточки постов с датами, заголовками и описаниями",
    "Добавить базовую логику интерфейса (кнопка добавления статьи, навигация)",
    "Собрать адаптивный интерфейс для десктопа и мобильных устройств"
  ],

  constraints: [
    "Проект учебный, без реальной CMS и базы данных",
    "Концепт без серверной части и авторизации",
    "Часть текстов и структуры сгенерирована нейросетями",
    "Важно было сохранить ощущение простоты и лёгкости интерфейса"
  ],

  solution:
    "Я начал с определения идеи блога и его настроения — минимализм, воздух, акцент на тексте. С помощью нейросетей сформировал направления по структуре и примеры контента. Затем вручную реализовал интерфейс: аккуратную сетку карточек, типографику, отступы и визуальный ритм. Основной упор сделал на читаемость, спокойный тон и ощущение личного пространства для мыслей.",

  technologies: [
    { name: "HTML5", desc: "Семантическая структура страниц и карточек статей" },
    { name: "CSS3", desc: "Минималистичная стилизация, отступы, типографика и адаптивность" },
    { name: "JavaScript (ES6+)", desc: "Базовая логика интерфейса и поведение элементов" },
    { name: "Нейросети (AI-инструменты)", desc: "Генерация идей, текстов и концепции интерфейса" }
  ],

  results: [
    "Создан учебный концепт блога с чистым интерфейсом",
    "Реализована структура карточек статей и навигации",
    "Сайт корректно выглядит на десктопе и мобильных устройствах",
    "Отработаны принципы минималистичного UI и типографики",
    "Проект оформлен и добавлен в портфолио"
  ],

  screenshots: {
    desktop: "images/screen5.jpg"
  },

  role:
    "Я выступал в роли дизайнера и фронтенд-разработчика: сформировал концепцию блога, структуру страниц и интерфейса, использовал нейросети для генерации идей и текстов, затем самостоятельно реализовал и оформил проект.",

  summary:
    "Этот учебный проект стал практикой создания контентного интерфейса без перегрузки визуальными элементами. Я сосредоточился на типографике, ритме и логике подачи информации, используя нейросети как инструмент для ускорения идей, а финальное качество доводил вручную."
},
{
  id: 6,
  title: "Aero X1",
  tag: "Product Showroom",
  description:
    "Учебный концепт презентационного сайта (шоурума) технологичного продукта, созданный как практика проектирования продуктовых интерфейсов с использованием нейросетей.",

  image: "images/case6.png",
  link: "https://papagama.github.io/aero-x1-showroom/",

  // Extended attributes for Case Study
  overview:
    "Учебный концептуальный проект презентационного сайта для вымышленного технологичного продукта Aero X1. Цель — создать эффектный, современный и понятный шоурум, который последовательно раскрывает продукт: от первого экрана и ключевой идеи до характеристик, преимуществ и визуального образа. Проект выполнен как практика работы с продуктовым сторителлингом и нейросетями.",

  client: "Учебный проект (самостоятельная работа)",
  year: "2026",

  tasks: [
    "Сформировать концепцию продуктового шоурума",
    "Продумать структуру страницы с акцентом на первый экран и сторителлинг",
    "Последовательно раскрыть продукт через блоки преимуществ и характеристик",
    "Создать визуально чистый и технологичный интерфейс",
    "Обеспечить корректную адаптацию под разные устройства"
  ],

  constraints: [
    "Проект учебный, без реального продукта и заказчика",
    "Концепт без сложной бизнес-логики и серверной части",
    "Часть идей и текстов сгенерирована нейросетями",
    "Важно было сохранить баланс между визуальным эффектом и читаемостью"
  ],

  solution:
    "Я начал с формирования образа продукта и его характера: технологичность, скорость, инновации. С помощью нейросетей сформировал концепцию, тексты и направления по визуальному стилю. Затем вручную выстроил структуру страницы: сильный первый экран, блоки с преимуществами, характеристиками и визуальными акцентами. Основной упор сделал на ритм, контраст, типографику и ощущение «продуктового сайта», а не обычного лендинга.",

  technologies: [
    { name: "HTML5", desc: "Семантическая структура и логика секций шоурума" },
    { name: "CSS3", desc: "Современная стилизация, сетки, типографика и визуальные акценты" },
    { name: "JavaScript (ES6+)", desc: "Поведение интерфейса и базовая интерактивность" },
    { name: "Нейросети (AI-инструменты)", desc: "Генерация концепции, текстов и идей визуальной подачи" }
  ],

  results: [
    "Создан учебный продуктовый шоурум с цельной визуальной подачей",
    "Выстроена логика раскрытия продукта от идеи к деталям",
    "Интерфейс корректно выглядит на десктопе и мобильных устройствах",
    "Отработаны принципы продуктового сторителлинга",
    "Проект оформлен и добавлен в портфолио"
  ],

  screenshots: {
    desktop: "images/screen6.jpg"
  },

  role:
    "Я выступал в роли дизайнера и фронтенд-разработчика: сформировал концепцию продукта и шоурума, использовал нейросети для генерации идей и текстов, затем самостоятельно реализовал структуру, визуальную подачу и адаптацию интерфейса.",

  summary:
    "Этот учебный проект стал практикой создания продуктового презентационного сайта. Я отработал логику шоурума, визуальный ритм и сторителлинг, используя нейросети как инструмент для ускорения концепции, а финальное качество и интерфейс доводил вручную."
},
{
  id: 7,
  title: "BRUTAL*STUDIO",
  tag: "Landing",
  description:
    "Учебный концепт сайта креативной студии в стиле брутализм: жирная типографика, жёсткие контрасты и «ломаю правила» подача, сделанный как практика нестандартных UI-приёмов и структуре агентского портфолио.",

  image: "images/case7.png",
  link: "https://papagama.github.io/brutalist/",

  // Extended attributes for Case Study
  overview:
    "Учебный концептуальный проект сайта креативной студии BRUTAL*STUDIO. Цель — собрать цельный «агентский» лендинг в бруталистичной эстетике: громкий первый экран, понятные услуги, блок избранных работ, манифест, команда и контактная форма. Проект сделан как тренировка визуального ритма (это когда блоки чередуются так, чтобы глаз не уставал), контраста и смелой типографики, с упором на атмосферу «экспериментального дизайна».",

  client: "Учебный проект (самостоятельная работа)",
  year: "2026",

  tasks: [
    "Сформировать концепцию и характер студии (эксперимент, провокация, контраст)",
    "Собрать структуру лендинга агентства: hero → услуги → избранные работы → манифест → команда → контакты/форма",
    "Сделать бруталистичный UI: крупная типографика, сетка, резкие цветовые акценты, простые геометрические маркеры",
    "Продумать карточки услуг и работ (читабельно, но с характером)",
    "Сверстать страницу и обеспечить адаптацию под разные экраны",
    "Добавить базовую интерактивность: навигация по секциям, hover-состояния, микро-анимации (по необходимости)"
  ],

  constraints: [
    "Проект концептуальный: студия и портфолио вымышленные, без реального заказчика",
    "Главный риск — «перебор» с брутализмом: важно сохранить читаемость и иерархию текста",
    "Нужно держать баланс между декоративными приёмами и удобством (чтобы сайт не был «постером», а оставался сайтом)",
    "Без сложной серверной части: форма и контент — демонстрационные"
  ],

  solution:
    "Я начал с идеи студии: «мы создаём цифровые артефакты» — то есть делаем дизайн как объект искусства, а не просто «красивую обёртку». Далее выстроил сценарий страницы: сильный первый экран с цифрами и настроением, затем блок услуг (брендинг, веб-дизайн, motion, art direction), потом избранные работы, манифест как усиление характера, команда для доверия и финальный контактный блок с формой. В визуале сделал ставку на крупную типографику, жёсткие цветовые акценты и простую геометрию — чтобы сайт ощущался дерзко, но оставался понятным и аккуратно собранным.",

  technologies: [
    { name: "HTML5", desc: "Семантическая структура секций: услуги, работы, манифест, команда, контакты" },
    { name: "CSS3", desc: "Сетка, контрастные блоки, типографика, оформление карточек и акцентных элементов" },
    { name: "JavaScript (ES6+)", desc: "Базовая интерактивность интерфейса: навигация, состояния, мелкие эффекты (если используются)" }
  ],

  results: [
    "Собран цельный концепт агентского лендинга в бруталистичной стилистике",
    "Проработана понятная структура: от первого экрана до формы заявки",
    "Сформирован «характер» бренда через манифест и визуальные решения",
    "Страница аккуратно сверстана и адаптирована под разные устройства",
    "Проект оформлен и добавлен в портфолио"
  ],

  screenshots: {
    desktop: "images/screen7.jpg"
  },

  role:
    "Я выступал в роли дизайнера и фронтенд-разработчика: придумал концепцию и структуру страницы, собрал визуальный стиль в бруталистичной эстетике и реализовал интерфейс на вёрстке, уделяя внимание иерархии, контрасту и адаптации.",

  summary:
    "BRUTAL*STUDIO — это учебная практика «смелого интерфейса»: я отработал бруталистичную подачу, крупную типографику и агентскую структуру сайта, сохранив при этом читабельность и понятный путь пользователя к форме заявки."
}


    // Placeholder items need data too to avoid errors, 
    // but simplified since they are just for pagination demo
];

// ===========================================
// СОСТОЯНИЕ ПРИЛОЖЕНИЯ
// ===========================================

// Текущая страница пагинации (начинается с 1)
let currentPage = 1;

// ===========================================
// ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ
// ===========================================

/**
 * Вычисляет общее количество страниц
 * @returns {number} Количество страниц
 */
function getTotalPages() {
    return Math.ceil(portfolioData.length / ITEMS_PER_PAGE);
}

/**
 * Получает работы для текущей страницы
 * @param {number} page - Номер страницы
 * @returns {Array} Массив работ для отображения
 */
function getItemsForPage(page) {
    // Вычисляем начальный и конечный индексы
    const startIndex = (page - 1) * ITEMS_PER_PAGE;
    const endIndex = startIndex + ITEMS_PER_PAGE;
    
    // Возвращаем срез массива
    return portfolioData.slice(startIndex, endIndex);
}

// ===========================================
// ГЕНЕРАЦИЯ HTML
// ===========================================

/**
 * Создает SVG-иконку стрелки для карточки
 * @returns {string} HTML-строка с SVG
 */
function createArrowSVG() {
    return `
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 17L17 7M17 7H7M17 7V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    `;
}

/**
 * Создает HTML-разметку для одной карточки работы
 * @param {Object} item - Объект с данными о работе
 * @returns {string} HTML-строка карточки
 */
/**
 * Создает HTML-разметку для одной карточки работы
 * @param {Object} item - Объект с данными о работе
 * @returns {string} HTML-строка карточки
 */
function createPortfolioCard(item) {
    return `
        <a href="case.html?id=${item.id}" class="portfolio__item reveal">
            <div class="portfolio__image">
                <img src="${item.image}" alt="${item.title}" loading="lazy" width="800" height="600">
                <div class="portfolio__overlay">
                    <span class="portfolio__arrow">
                        ${createArrowSVG()}
                    </span>
                </div>
            </div>
            <div class="portfolio__content">
                <span class="portfolio__tag">${item.tag}</span>
                <h3 class="portfolio__name">${item.title}</h3>
                <p class="portfolio__description">${item.description.substring(0, 100)}...</p>
            </div>
        </a>
    `;
}

/**
 * Создает HTML-разметку для кнопок пагинации
 * @returns {string} HTML-строка пагинации
 */
function createPagination() {
    const totalPages = getTotalPages();
    
    // Если страница одна — пагинация не нужна
    if (totalPages <= 1) {
        return '';
    }
    
    let paginationHTML = '<div class="pagination">';
    
    // Кнопка "Назад"
    paginationHTML += `
        <button class="pagination__btn pagination__btn--prev ${currentPage === 1 ? 'pagination__btn--disabled' : ''}" 
                ${currentPage === 1 ? 'disabled' : ''} 
                data-action="prev">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    `;
    
    // Номера страниц
    paginationHTML += '<div class="pagination__numbers">';
    for (let i = 1; i <= totalPages; i++) {
        paginationHTML += `
            <button class="pagination__number ${i === currentPage ? 'pagination__number--active' : ''}" 
                    data-page="${i}">
                ${i}
            </button>
        `;
    }
    paginationHTML += '</div>';
    
    // Кнопка "Вперед"
    paginationHTML += `
        <button class="pagination__btn pagination__btn--next ${currentPage === totalPages ? 'pagination__btn--disabled' : ''}" 
                ${currentPage === totalPages ? 'disabled' : ''} 
                data-action="next">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </button>
    `;
    
    paginationHTML += '</div>';
    
    return paginationHTML;
}

// ===========================================
// РЕНДЕРИНГ
// ===========================================

/**
 * Отрисовывает карточки работ и пагинацию
 * Вызывается при загрузке страницы и при переключении страниц
 */
function renderPortfolio() {
    // Находим контейнер для сетки
    const gridContainer = document.getElementById('portfolio-grid');
    // Находим контейнер для пагинации
    const paginationContainer = document.getElementById('portfolio-pagination');
    
    if (!gridContainer) {
        return; // Если контейнера нет (например, мы на странице кейса), просто выходим
    }
    
    // Получаем работы для текущей страницы
    const items = getItemsForPage(currentPage);
    
    // Генерируем HTML для карточек
    const cardsHTML = items.map(item => createPortfolioCard(item)).join('');
    
    // Вставляем карточки в DOM
    gridContainer.innerHTML = cardsHTML;
    
    // Генерируем и вставляем пагинацию
    if (paginationContainer) {
        paginationContainer.innerHTML = createPagination();
        // Добавляем обработчики для кнопок пагинации
        attachPaginationHandlers();
    }
    
    // Запускаем анимацию появления для новых карточек
    animateCards();
}

/**
 * Добавляет анимацию появления для карточек
 */
function animateCards() {
    // Небольшая задержка для корректной работы CSS-transition
    setTimeout(() => {
        const cards = document.querySelectorAll('#portfolio-grid .reveal');
        cards.forEach((card, index) => {
            // Добавляем задержку для каскадного эффекта
            setTimeout(() => {
                card.classList.add('active');
            }, index * 100);
        });
    }, 50);
}

// ===========================================
// ЛОГИКА СТРАНИЦЫ КЕЙСА
// ===========================================

function initCaseStudy() {
    const heroTitle = document.getElementById('case-title');
    if (!heroTitle) return; // Not on case page

    // Get ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    const caseId = parseInt(urlParams.get('id'), 10);

    if (!caseId) {
        window.location.href = 'index.html';
        return;
    }

    const item = portfolioData.find(project => project.id === caseId);

    if (!item) {
        heroTitle.textContent = 'Project not found';
        return;
    }

    // 1. Hero
    document.title = `${item.title} — Case Study`;
    heroTitle.textContent = item.title || "Untitled Project";
    setText('case-hero-desc', item.description);
    
    const heroBg = document.getElementById('hero-bg');
    if (heroBg && item.image) {
        heroBg.style.backgroundImage = `url('${item.image}')`;
    }

    const stackContainer = document.getElementById('case-stack');
    if (stackContainer && item.technologies) {
        stackContainer.innerHTML = item.technologies.slice(0, 4).map(t => 
            `<span class="stack-badge">${t.name}</span>`
        ).join('');
    }

    // 2. Overview
    setText('case-overview', item.overview || "Описание проекта временно отсутствует.");
    
    const metaContainer = document.getElementById('case-meta');
    if (metaContainer) {
        metaContainer.innerHTML = `
            <div class="meta-item"><span>Client</span>${item.client || "Confidential"}</div>
            <div class="meta-item"><span>Year</span>${item.year || "2024"}</div>
            <div class="meta-item"><span>Type</span>${item.tag || "Website"}</div>
        `;
    }

    // 3. Tasks & Constraints
    fillList('case-tasks', item.tasks);
    fillList('case-constraints', item.constraints);

    // 4. Solution
    setText('case-solution', item.solution || "Решение в процессе описания.");

    // 5. Technologies
    const techContainer = document.getElementById('case-technologies');
    if (techContainer && item.technologies) {
        techContainer.innerHTML = item.technologies.map(t => `
            <div class="tech-item">
                <h4>${t.name}</h4>
                <p>${t.desc}</p>
            </div>
        `).join('');
    }

    // 6. Results
    fillList('case-results', item.results);
    
    var linkWrap = document.getElementById('case-site-link-wrap');
    if (linkWrap && item.link && item.link !== '#') {
        linkWrap.innerHTML = '';
        var a = document.createElement('a');
        a.href = item.link;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.className = 'btn';
        a.innerHTML = '<span>Посмотреть сайт</span>';
        linkWrap.appendChild(a);
    }

    // 7. Screenshots — путь от папки с case.html (./ чтобы грузилось и с file:// и на хостинге)
    const screenContainer = document.getElementById('case-screenshots');
    if (screenContainer) {
        function src(path) {
            if (!path) return '';
            if (path.indexOf('http') === 0 || path.indexOf('//') === 0) return path;
            return path.charAt(0) === '/' ? path : './' + path.replace(/^\.\//, '');
        }
        const screens = item.screenshots || {};
        const desktopSrc = screens.desktop || item.image;
        const imgStyle = 'display:block!important;opacity:1!important;visibility:visible!important;transform:none!important;margin:20px auto!important;max-width:90%!important;width:auto!important;height:auto!important;border-radius:16px!important;box-shadow:0 30px 80px rgba(0,0,0,0.15)!important';
        let screensHTML = '';
        if (desktopSrc) {
            const fallback = item.image && item.image !== desktopSrc ? item.image : '';
            screensHTML += '<img src="' + src(desktopSrc) + '" alt="Экран сайта" loading="lazy" style="' + imgStyle + '"' + (fallback ? ' data-fb="' + src(fallback) + '" onerror="var f=this.getAttribute(\'data-fb\');if(f){this.src=f;this.removeAttribute(\'data-fb\')}"' : '') + '>';
        }
        if (screens.tablet) {
            screensHTML += '<img src="' + src(screens.tablet) + '" alt="Планшет" loading="lazy" style="' + imgStyle + 'max-width:70%!important;">';
        }
        if (screens.mobile) {
            screensHTML += '<img src="' + src(screens.mobile) + '" alt="Мобильный" loading="lazy" style="' + imgStyle + 'max-width:30%!important;">';
        }
        screenContainer.innerHTML = screensHTML || '<p class="text-muted">Скриншоты подготавливаются…</p>';
        // Сразу показываем секцию и картинки (не ждём reveal/observer)
        var section = screenContainer.closest('.case-section');
        if (section) {
            section.classList.add('active');
            section.style.opacity = '1';
            section.style.transform = 'none';
        }
        screenContainer.querySelectorAll('img').forEach(function (img) {
            img.classList.add('active');
            img.style.opacity = '1';
            img.style.visibility = 'visible';
            img.style.transform = 'none';
        });
    }

    // 8. Role
    setText('case-role', item.role || "Разработка и верстка.");

    // 9. Summary
    setText('case-summary', item.summary || "Проект успешно завершен.");

    // Инициализация анимации для динамического контента (скриншотов)
    setTimeout(() => {
        const dynamicReveals = document.querySelectorAll('#case-screenshots .reveal');
        
        if (dynamicReveals.length > 0) {
            if ('IntersectionObserver' in window) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('active');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                
                dynamicReveals.forEach(el => observer.observe(el));
            } else {
                dynamicReveals.forEach(el => el.classList.add('active'));
            }
        }
    }, 100);
}

// Helper to safely set text content
function setText(id, text) {
    const el = document.getElementById(id);
    if (el) el.textContent = text || "";
}

// Helper to fill UL lists
function fillList(id, items) {
    const el = document.getElementById(id);
    if (!el) return;
    
    if (items && items.length > 0) {
        el.innerHTML = items.map(i => `<li>${i}</li>`).join('');
    } else {
        el.innerHTML = '<li class="text-muted">Информация уточняется</li>';
    }
}

// ===========================================
// ОБРАБОТЧИКИ СОБЫТИЙ
// ===========================================

/**
 * Привязывает обработчики кликов к кнопкам пагинации
 */
function attachPaginationHandlers() {
    const paginationContainer = document.getElementById('portfolio-pagination');
    
    if (!paginationContainer) return;
    
    // Используем делегирование событий
    paginationContainer.addEventListener('click', (e) => {
        const target = e.target.closest('button');
        
        if (!target) return;
        
        // Обработка клика по номеру страницы
        if (target.dataset.page) {
            const page = parseInt(target.dataset.page, 10);
            if (page !== currentPage) {
                currentPage = page;
                renderPortfolio();
                scrollToPortfolio();
            }
        }
        
        // Обработка клика по кнопке "Назад"
        if (target.dataset.action === 'prev' && currentPage > 1) {
            currentPage--;
            renderPortfolio();
            scrollToPortfolio();
        }
        
        // Обработка клика по кнопке "Вперед"
        if (target.dataset.action === 'next' && currentPage < getTotalPages()) {
            currentPage++;
            renderPortfolio();
            scrollToPortfolio();
        }
    });
}

/**
 * Плавная прокрутка к секции портфолио при переключении страниц
 */
function scrollToPortfolio() {
    const worksSection = document.getElementById('works');
    if (worksSection) {
        // Плавный скролл к началу секции с небольшим отступом
        const headerHeight = 80;
        const sectionTop = worksSection.offsetTop - headerHeight;
        
        window.scrollTo({
            top: sectionTop,
            behavior: 'smooth'
        });
    }
}

// ===========================================
// ИНИЦИАЛИЗАЦИЯ
// ===========================================

/**
 * Инициализирует модуль портфолио при загрузке DOM
 */
function initPortfolio() {
    renderPortfolio();
    initCaseStudy();
}

// Запускаем инициализацию когда DOM готов
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initPortfolio);
} else {
    // DOM уже загружен
    initPortfolio();
}
